<!DOCTYPE html>
</style>
</head>


<body>


<div id="bill">


<div class="header">
<img src="logo.png" class="logo"><br>
<b>NAVEED TEXTILES</b><br>
Email: naveedtextiles14@gmail.com
</div>


<hr>


<b>Bill No:</b> <span id="invoice"></span><br>
<b>Date:</b> ðŸ“… <span id="date"></span>


<hr>


<table id="items">
<tr><th>#</th><th>Item</th><th>Qty</th><th>Price</th><th>Amount</th></tr>
<tr>
<td>1</td>
<td><input></td>
<td><input type="number" oninput="calc()"></td>
<td><input type="number" oninput="calc()"></td>
<td class="amt">0</td>
</tr>
</table>


<button onclick="addRow()">Add Item</button>


<hr>


Discount % <input id="disc" type="number" value="0" oninput="calc()">
Paid â‚¹ <input id="paid" type="number" value="0" oninput="calc()">


<h3 id="total">Total: â‚¹0</h3>
<h3 id="balance">Balance: â‚¹0</h3>


<hr>


<b>Authorized Signature</b><br>
<canvas id="sign" width="300" height="120"></canvas><br>
<button onclick="clearSign()">Clear Signature</button>


<hr>


<center>Web built by Mautasim</center>
</div>


<br>
<button onclick="downloadPDF()">Download PDF</button>
<button onclick="whatsappPDF()">WhatsApp PDF</button>


<script>
// Invoice + date
let last = localStorage.getItem('invoice') || 1000;
last++;
localStorage.setItem('invoice', last);
document.getElementById('invoice').innerText = 'INV-' + last;
document.getElementById('date').innerText = new Date().toISOString().split('T')[0];


function addRow(){
let t=document.getElementById('items');
let r=t.insertRow();
r.innerHTML=`<td>${t.rows.length-1}</td><td><input></td><td><input type=number oninput=calc()></td><td><input type=number oninput=calc()></td><td class=amt>0</td>`;
}


function calc(){
let sum=0;
document.querySelectorAll('#items tr').forEach((r,i)=>{
if(i>0){
let q=r.cells[2].firstChild.value||0;
let p=r.cells[3].firstChild.value||0;
let a=q*p;
r.cells[4].innerText=a;
sum+=a;
}}
);
let d=sum*(disc.value/100);
let total=sum-d;
document.getElementById('total').innerText='Total: â‚¹'+total;
let bal=total-(paid.value||0);
document.getElementById('balance').innerText='Balance: â‚¹'+(bal>0?bal:0);
}


// Signature
let c=document.getElementById('sign');
let ctx=c.getContext('2d');
let draw=false;
c.onmousedown=()=>draw=true;
c.onmouseup=()=>draw=false;
c.onmousemove=e=>{if(draw){ctx.lineTo(e.offsetX,e.offsetY);ctx.stroke();}};
function clearSign(){ctx.clearRect(0,0,c.width,c.height)}


// PDF
function downloadPDF(){
html2pdf().set({filename:'Invoice.pdf',html2canvas:{scale:2}}).from(document.getElementById('bill')).save();
}


function whatsappPDF(){
downloadPDF();
setTimeout(()=>{
window.open('https://wa.me/?text=Invoice generated. Please attach PDF');
},1500);
}
</script>


</body>
</html>
